webpackJsonp([8],{CU5G:function(e,t){},Ovvg:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("lC5x"),o=i.n(n),a=i("HzJ8"),r=i.n(a),l=i("J0Oq"),s=i.n(l),c=i("C/I2"),d=i("/Tkm"),u=i("cAgV"),m=i("ifD2"),p=i("0xDb"),f={name:"RoleDialog",data:function(){return{dialog:{title:null,visible:!1},type_id:null,form:{name:null,desc:null},formRules:{name:[{required:!0,message:"请输入一级分类",trigger:"blur"}]}}},methods:{showTypeDialog:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.dialog.visible=!0,this.dialog.title=t?"修改商品种类【"+t.name+"】 "+t.id:"创建商品种类",this.$nextTick(function(){if(e.$refs.form.clearValidate(),!t)return e.type_id=null,void e.$refs.form.resetFields();e.type_id=t.id,e.form.first_name=t.name,e.form.second_name=Object(p.d)(t.commodity_second_type,"name").join("\n"),e.form.desc=t.desc})},updateCT:function(){var e,t=this;this.$refs.form.validate((e=s()(o.a.mark(function e(i){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return",!1);case 2:if(!t.type_id){e.next=7;break}return e.next=5,Object(m.h)(t.type_id,t.form);case 5:e.next=9;break;case 7:return e.next=9,Object(m.b)(t.form);case 9:t.$message.success("更新成功"),t.dialog.visible=!1,t.$emit("getCommodityList");case 12:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:"40%","close-on-press-escape":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[i("el-row",{staticStyle:{"margin-bottom":"20px","margin-top":"-8px"}},[i("div",{staticClass:"div_title"},[i("span",[e._v("商品种类信息")])])]),e._v(" "),i("el-row",[i("el-col",{attrs:{span:21}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"一级分类:",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入一级分类"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"描述:",prop:"desc"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1)],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialog.visible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.updateCT}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var y=i("C7Lr")(f,v,!1,function(e){i("e2+8")},"data-v-2402751a",null).exports,b=i("psq8"),g=i.n(b),_=i("4YfN"),h=i.n(_),w=i("ZLEe"),x=i.n(w),k={name:"PriceDialog",directives:{waves:u.a},data:function(){return{dialog:{title:null,visible:!1},innerVisible:!1,name:null,commodity_type_id:null,secondType:[],second_id:null,listLoading:!0,form:{name:null},formRules:{name:[{required:!0,message:"请输入二级分类名称",trigger:"blur"}]}}},methods:{showSecondDialog:function(e){var t=this;this.dialog.visible=!0,this.dialog.title="设置【"+e.name+"】价格",this.name=e.name,this.$nextTick(function(){t.commodity_type_id=e.id,t.getSecondType()})},getSecondType:function(){var e=this,t={};this.commodity_type_id&&(t.commodity_type=this.commodity_type_id),Object(m.e)(t).then(function(t){e.secondType=t._items.map(function(t){return e.$set(t,"visible",!1),t}),e.listLoading=!1})},deleteSecondType:function(e){var t=this;return s()(o.a.mark(function i(){return o.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(m.c)(e.id);case 2:t.$message.success("删除成功"),t.$emit("getCommodityList"),t.getSecondType();case 5:case"end":return i.stop()}},i,t)}))()},editSecondDialog:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.innerVisible=!0,this.$nextTick(function(){e.$refs.form.clearValidate(),t?(e.form=g.a.pick(t,x()(e.form)),e.second_id=t.id):(e.$refs.form.resetFields(),e.second_id=null)})},updateCommodityType:function(){var e,t=this;this.$refs.form.validate((e=s()(o.a.mark(function e(i){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return",!1);case 2:if(!t.second_id){e.next=7;break}return e.next=5,Object(m.g)(t.second_id,t.form);case 5:e.next=9;break;case 7:return e.next=9,Object(m.a)(h()({},t.form,{commodity_type:t.commodity_type_id}));case 9:t.$message.success("更新成功"),t.$emit("getCommodityList"),t.getSecondType(),t.innerVisible=!1;case 13:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)}))}}},C={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.visible,width:"50%"},on:{"update:visible":function(t){return e.$set(e.dialog,"visible",t)}}},[i("el-dialog",{attrs:{title:"设置二级分类",visible:e.innerVisible,"append-to-body":""},on:{"update:visible":function(t){e.innerVisible=t}}},[i("el-row",{staticStyle:{"margin-bottom":"20px","margin-top":"-8px"}},[i("div",{staticClass:"div_title"},[i("span",[e._v("一级分类名称:")]),e._v(" "),i("span",{staticClass:"span-color",staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.name))])])]),e._v(" "),i("el-row",[i("el-col",{attrs:{span:21}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"名称:",prop:"name"}},[i("el-input",{attrs:{placeholder:"请输入名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",[i("el-button",{on:{click:function(t){e.innerVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.updateCommodityType}},[e._v("确 定")])],1)],1)],1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-bottom":"20px","margin-top":"-8px"}},[i("div",{staticClass:"div_title"},[i("span",[e._v("一级分类名称:")]),e._v(" "),i("span",{staticClass:"span-color",staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.name))])])]),e._v(" "),i("el-row",[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"success"},on:{click:function(t){return e.editSecondDialog("")}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" "),i("span",[e._v("创 建")])])],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"table",attrs:{data:e.secondType,border:"",fit:""}},[i("el-table-column",{attrs:{prop:"name",label:"名称",width:"150",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.editSecondDialog(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(i){e.$set(t.row,"visible",i)},expression:"scope.row.visible"}},[i("p",[e._v("确认删除分类名称？")]),e._v(" "),i("div",{staticStyle:{"text-align":"right",margin:"0"}},[i("el-button",{attrs:{size:"mini",plain:"",type:"info"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(i){return e.deleteSecondType(t.row)}}},[e._v("确定")])],1),e._v(" "),i("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])})],1)],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialog.visible=!1}}},[e._v("取 消")])],1)],1)},staticRenderFns:[]};var T=i("C7Lr")(k,C,!1,function(e){i("CU5G")},"data-v-c6c13e2a",null).exports,$={name:"index",components:{PanelTitle:c.a,TableFoot:d.a,TypeDialog:y,SecondDialog:T},directives:{waves:u.a},data:function(){return{listLoading:!0,typeList:[],filters:{},selectedType:[]}},created:function(){this.getCommodityList()},methods:{getCommodityList:function(){var e=this;Object(m.f)(this.filters,{commodity_second_type:!0}).then(function(t){e.typeList=t._items,e.listLoading=!1})},setSelection:function(e){this.selectedType=Object(p.d)(e,"id")},selectionChange:function(e){this.$refs.tableFoot.selectionChange(e)},createCommodityType:function(){this.$refs.typeDialog.showTypeDialog()},editCommodityType:function(e){this.$refs.typeDialog.showTypeDialog(e)},deleteCommodityType:function(e){var t=this,i=g.a.isArray(e)?e:[e.id];this.$confirm("此操作将删商品种类, 是否继续?","提示",{type:"warning"}).then(function(){t.listLoading=!0,t.deleteComType(i).then(function(){t.getCommodityList(),t.listLoading=!1,t.$message.success("删除成功")}).catch(function(){return t.listLoading=!1})}).catch(function(){return console.log("no deleted")})},deleteComType:function(e){var t=this;return s()(o.a.mark(function i(){var n,a,l,s,c,d;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||!e.length){t.next=27;break}n=!0,a=!1,l=void 0,t.prev=4,s=r()(e);case 6:if(n=(c=s.next()).done){t.next=13;break}return d=c.value,t.next=10,Object(m.d)(d);case 10:n=!0,t.next=6;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(4),a=!0,l=t.t0;case 19:t.prev=19,t.prev=20,!n&&s.return&&s.return();case 22:if(t.prev=22,!a){t.next=25;break}throw l;case 25:return t.finish(22);case 26:return t.finish(19);case 27:return t.abrupt("return",!0);case 28:case"end":return t.stop()}},i,t,[[4,15,19,27],[20,,22,26]])}))()},editCommoditySecondType:function(e){this.$refs.secondDialog.showSecondDialog(e)}}},L={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("panel-title",{attrs:{title:"商品种类","is-line":""}}),e._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.createCommodityType}},[e._v("创 建")])],1)],1),e._v(" "),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"table",attrs:{data:e.typeList,border:"",fit:""},on:{"selection-change":e.selectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"52",fixed:"",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"id",label:"ID",sortable:"",fixed:"",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"一级分类",sortable:"",width:"180"}}),e._v(" "),i("el-table-column",{attrs:{label:"二级分类",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.commodity_second_type,function(t){return i("el-tag",{key:t.id,staticClass:"mr-5"},[e._v(e._s(t.name))])})}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"desc",label:"描述",width:"250"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.editCommoditySecondType(t.row)}}},[e._v("设置二级分类")]),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.editCommodityType(t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.deleteCommodityType(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("table-foot",{ref:"tableFoot",attrs:{"data-length":e.typeList.length},on:{setSelection:e.setSelection,clearSelection:function(t){return e.$refs.table.clearSelection()},toggleAllSelection:function(t){return e.$refs.table.toggleAllSelection()}}},[i("template",{slot:"foot"},[i("span",[i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:!e.selectedType.length},on:{click:function(t){return e.deleteCommodityType(e.selectedType)}}},[e._v("删 除")])],1)])],2)],1)],1),e._v(" "),i("type-dialog",{ref:"typeDialog",on:{getCommodityList:e.getCommodityList}}),e._v(" "),i("second-dialog",{ref:"secondDialog",on:{getCommodityList:e.getCommodityList}})],1)},staticRenderFns:[]};var S=i("C7Lr")($,L,!1,function(e){i("enln")},"data-v-453ddfcd",null);t.default=S.exports},"e2+8":function(e,t){},enln:function(e,t){},ifD2:function(e,t,i){"use strict";t.f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object(a.a)({url:"/commodity_type?where="+o()(e)+"&embedded="+o()(t)+"&sort="+i,method:"get"})},t.b=function(e){return Object(a.a)({url:"/commodity_type",method:"post",data:e})},t.h=function(e,t){return Object(a.a)({url:"/commodity_type/"+e,method:"patch",data:t})},t.d=function(e){return Object(a.a)({url:"/commodity_type/"+e,method:"delete"})},t.e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return Object(a.a)({url:"/commodity_second_type?where="+o()(e)+"&embedded="+o()(t)+"&sort="+i,method:"get"})},t.a=function(e){return Object(a.a)({url:"/commodity_second_type",method:"post",data:e})},t.g=function(e,t){return Object(a.a)({url:"/commodity_second_type/"+e,method:"patch",data:t})},t.c=function(e){return Object(a.a)({url:"/commodity_second_type/"+e,method:"delete"})};var n=i("3cXf"),o=i.n(n),a=i("vLgD")}});
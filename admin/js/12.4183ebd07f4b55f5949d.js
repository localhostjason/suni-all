webpackJsonp([12],{CLug:function(e,t){},F6rI:function(e,t){},FonL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("4YfN"),n=a.n(r),i=a("C/I2"),l=a("B4UA"),s=a("0xDb"),o={name:"WithdrawFilter",directives:{waves:a("cAgV").a},props:{type:{type:String,required:!0}},data:function(){return{pickerOptions:s.f,argsQuery:{time:""}}},methods:{handleFilter:function(){this.argsQuery.type=this.type,this.$emit("filterRebate",this.argsQuery)}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:24}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions},model:{value:e.argsQuery.time,callback:function(t){e.$set(e.argsQuery,"time",t)},expression:"argsQuery.time"}}),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("查 询")])],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(o,u,!1,function(e){a("Wg/n")},"data-v-13811ea2",null).exports,c={name:"WithdrawTable",props:{data:{type:Array,required:!0},total:null,pageQuery:{type:Object,required:!0},listLoading:{type:Boolean,required:!0,default:!0},type:{type:String,required:!0}},data:function(){return{downloadLoading:!1,loading:this.listLoading}},watch:{listLoading:function(e){this.loading=e}},methods:{getEnumName:s.c,handleSizeChange:function(e){this.pageQuery.max_results=e,this.$emit("getRebateList")},handleCurrentChange:function(e){this.pageQuery.page=e,this.$emit("getRebateList")},updateRebate:function(e,t){var a=this,r={};"ok"===t?(r.type="withdrawed",r.desc="兑换成功"):(r.type="withdraw_deny",r.type="拒绝兑换"),Object(l.e)(e.id,r).then(function(e){a.$message.success("更新成功"),a.$emit("getRebateList")})},formatJson:function(e,t){return t.map(function(t){return e.map(function(e){return"timestamp"===e?Object(s.e)(t[e]):t[e]})})},handleDownload:function(){var e=this;this.downloadLoading=!0,a.e(21).then(a.bind(null,"zWO4")).then(function(t){var a=e.data,r=e.formatJson(["id","time","number","real_number","user.phone","user.real_name","user.type","user.id_card","user.we_chart","user.alipay"],a);t.export_json_to_excel({header:["ID","提交时间","兑换积分","到账金额","手机号","姓名","会员级别","身份证","微信号","支付宝"],data:r,filename:e.type,autoWidth:!0,bookType:"xlsx"}),e.downloadLoading=!1})}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",[a("el-button",{attrs:{loading:e.downloadLoading,type:"primary",icon:"document"},on:{click:e.handleDownload}},[e._v("\n      导出 Excel\n    ")])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.data,border:"",fit:""}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"time",label:"提交时间",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"number",label:"兑换积分",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s("￥"+t.row.number))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"real_number",label:"实际兑换积分",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s("￥"+t.row.real_number))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"user",label:"姓名/手机号",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(t.row.user.real_name||"--"))]),e._v(" "),a("div",{staticClass:"span-color"},[e._v(e._s(t.row.user.phone))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"user.type",label:"会员级别",sortable:"",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",[e._v(e._s(e.getEnumName(t.row.user.type)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"user.id_card",label:"身份证",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user.we_chart",label:"微信号",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"user.alipay",label:"支付宝"}}),e._v(" "),"withdrawing"===e.type?a("el-table-column",{attrs:{label:"操作",fixed:"right",align:"right",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.updateRebate(t.row,"ok")}}},[e._v("批准")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.updateRebate(t.row,"no")}}},[e._v("拒绝")])]}}],null,!1,1046750949)}):e._e()],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-pagination",{attrs:{"current-page":e.pageQuery.page,"page-sizes":[10,20,30,40],"page-size":e.pageQuery.max_results,total:e.total,background:"",layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},staticRenderFns:[]};var g=a("C7Lr")(c,p,!1,function(e){a("F6rI")},"data-v-e32c4224",null).exports,y={name:"index",components:{PanelTitle:i.a,WithdrawFilter:d,WithdrawTable:g},data:function(){return{reBateType:[{value:"withdrawing",label:"兑换申请"},{value:"withdrawed",label:"兑换成功"},{value:"withdraw_deny",label:"兑换拒绝"}],listLoading:!0,dataList:[],total:0,listQuery:{argsQuery:{},pageQuery:{page:1,max_results:10}},type:this.$route.query.type||"withdrawing"}},created:function(){this.getRebateList()},methods:{handleClickTab:function(e){this.type=e.name,this.listQuery.argsQuery={},this.listQuery.pageQuery={page:1,max_results:10},this.getRebateList()},filterRebate:function(e){this.listQuery.pageQuery.page=1,this.listQuery.argsQuery=e,this.getRebateList()},getRebateList:function(){var e=this,t=n()({},this.listQuery);t.argsQuery=Object(s.h)(t.argsQuery,"time"),t.argsQuery.type=this.type;this.listLoading=!0,Object(l.c)(t,{user:!0}).then(function(t){e.dataList=t._items,e.total=t._meta.total,e.listLoading=!1})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("panel-title",{attrs:{title:"兑换积分申请","is-line":""}}),e._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.handleClickTab},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},e._l(e.reBateType,function(t){return a("el-tab-pane",{key:t.value,attrs:{label:t.label,name:t.value}},[a("withdraw-filter",{attrs:{type:e.type},on:{filterRebate:e.filterRebate}}),e._v(" "),a("withdraw-table",{attrs:{data:e.dataList,"page-query":e.listQuery.pageQuery,total:e.total,"list-loading":e.listLoading,type:e.type},on:{getRebateList:e.getRebateList}})],1)}),1)],1)],1)],1)},staticRenderFns:[]};var b=a("C7Lr")(y,h,!1,function(e){a("CLug")},"data-v-ae3df1d2",null);t.default=b.exports},"Wg/n":function(e,t){}});